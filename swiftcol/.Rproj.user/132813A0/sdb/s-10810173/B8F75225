{
    "collab_server" : "",
    "contents" : "##----------------------------------------------------------------------------------------------------------##\n##  Cedric Scherer (cedricphilippscherer@gmail.com)                                                         ##\n##  RNetLogo Script for setting up a parallel session                                                       ##\n##  2018-02-28                                                                                              ##\n##----------------------------------------------------------------------------------------------------------##\n\n#### PREPARATION ---------------------------------------------------------------------------------------------\n\nlibrary(parallel)\n\nsource(\"./R/parameters.R\")\n#source(\"./R/nlms.R\")\nsource(\"./R/simulation-fun.R\")\n\n\n#### CLUSTER -------------------------------------------------------------------------------------------------\n\n(proc <- detectCores() - 6)\ncl <- makeCluster(proc, type = \"PSOCK\", methods = FALSE, outfile = \"\")\nshowConnections()\n\n\n#### PARAMETERS ----------------------------------------------------------------------------------------------\n\n### Sim()\nruns <- 1:length(nlms)  ## number of landscapes\n\n### Seed()\ns <- 1:proc  ## different seeds for each node\n\n### Output\nresults <- as.list(runs)\n\n\n############################################################################################################-\n#### CLUSTER SIMULATIONS -------------------------------------------------------------------------------------\n\n## export variables to nodes\nclusterExport(cl, c(\"nlms\", \"runs\"))\n\n## start NetLogo in each node\ninvisible(parLapply(cl, 1:proc, PreSim, gui = gui, nl_path = nl_path, model_path = model_path))\n\n## set seed for each node\nparSapply(cl, 1:proc, Seed)\n\n## start parallel simulations by calling parSapply\n(start <- Sys.time()); results <- parSapply(cl, runs, SimWeekly); (time <- Sys.time() - start)\n\n## save results\nsaveRDS(results, \"./Simulations/results_100x52.Rds\")\n\n## stop NetLogo + cluster\ninvisible(parLapply(cl, 1:proc, PostSim))\ncloseAllConnections()\n\n\n############################################################################################################-\n#### SINGLE SIMULATION --------------------------------------------------------------------------------------\n\nlibrary(RNetLogo)\nNLStart(nl_path, gui = T)\nNLLoadModel(model_path)\nresults <- sapply(1, SimWeekly)\nPostSim()\n",
    "created" : 1521196965534.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3104317443",
    "id" : "B8F75225",
    "lastKnownWriteTime" : 1521719311,
    "last_content_update" : 1521719310855,
    "path" : "M:/TEMP/NLMR/1_Simulation.R",
    "project_path" : "1_Simulation.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}